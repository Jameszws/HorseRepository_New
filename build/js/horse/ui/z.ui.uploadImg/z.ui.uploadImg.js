define([],function(){var e={inputFileCount:0,inputFilePrefix:"zwsuploadfile_",InputFileAreaIdFix:"zwsSpanArea_"},t=function(){this.defaultParams={fileAreaId:"",showNameAreaId:"",maxUploadCount:5}};return t.prototype={constructor:t,init:function(e){this.options=Horse.util.coverObject(this.defaultParams,e),this._init()},_init:function(){this.createInputFileArea(),this.createInputFile()},createInputFile:function(){var t=e.InputFileAreaIdFix+this.options.fileAreaId;e.inputFileCount++;var i=document.createElement("input");i.name=e.inputFilePrefix+e.inputFileCount,i.id=e.inputFilePrefix+e.inputFileCount,i.type="file",i.className="uploadfile";var n=Horse.util.delegate(this._handleOnchange,this,[{fileEl:i}]);i.onchange=n,document.getElementById(t).appendChild(i)},createInputFileArea:function(){var t=e.InputFileAreaIdFix+this.options.fileAreaId,i=document.createElement("span");i.id=t,i.className="spanarea",document.getElementById(this.options.fileAreaId).appendChild(i);var n=document.createElement("input");n.value="添加附件",n.className="btnfile",n.type="button",document.getElementById(t).appendChild(n)},isExistsPic:function(e){for(var t=document.getElementById(this.options.showNameAreaId).getElementsByTagName("span"),i=!1,n=0;n<t.length;n++)e.trim()==t[n].getAttribute("attrName").trim()&&(i=!0);return i},isOverMaxUploadCount:function(){return document.getElementById(this.options.showNameAreaId).getElementsByTagName("span").length>=this.options.maxUploadCount},getFileName:function(e){var t=e.lastIndexOf("/"),i=e.lastIndexOf("\\"),n=Math.max(t,i);return n<0?e:e.substring(n+1)},_handleOnchange:function(t){this.createInputFile();var i=t.fileEl,n=this.getFileName(i.value),a=e.InputFileAreaIdFix+this.options.fileAreaId;if(!Horse.validate.isPic(n))return alert("选择的图片文件类型出错，请重新选择"),void document.getElementById(a).removeChild(i);if(this.isExistsPic(n))return alert("该文件已经被选中，请重新选择！"),void document.getElementById(a).removeChild(i);if(this.isOverMaxUploadCount())return alert("已经达到上传上限！"),void document.getElementById(a).removeChild(i);var l=document.createElement("input");l.type="checkbox",l.checked="checked",l.style.marginLeft="20px";var o=Horse.util.delegate(this._handleCheckBoxClick,this,[{obj:l,fileElObj:i}]);l.onclick=o,document.getElementById(this.options.showNameAreaId).appendChild(l),l.checked="checked";var d=document.createElement("span");d.setAttribute("attrName",n),d.style.width="auto",d.style.marginLeft="5px",d.innerHTML=n,document.getElementById(this.options.showNameAreaId).appendChild(d);var r=document.createElement("br");document.getElementById(this.options.showNameAreaId).appendChild(r)},_handleCheckBoxClick:function(e){var t=e.obj,i=e.fileElObj;t.checked?i.removeAttribute("disabled"):i.disabled="disabled"}},t});